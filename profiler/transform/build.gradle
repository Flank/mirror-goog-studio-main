apply plugin: 'java'
apply plugin: 'org.anarres.jarjar'

group = 'com.android.tools'

archivesBaseName = 'profilers-transform-base'

buildscript {
    dependencies {
        classpath 'org.anarres.jarjar:jarjar-gradle:1.0.0'
    }
}

configurations {
    repackage
    support
}

jarjar.repackage('asm') {
    destinationName = "profilers-transform.jar"
    from configurations.repackage
    from jar.outputs.files
    classRename 'org.objectweb.asm.**', 'com.android.tools.profiler.asm.@1'
}
build.dependsOn asm

dependencies {
    repackage('org.ow2.asm:asm:5.0.4') { transitive = false }

    support project(":supportlib")
    compile 'org.ow2.asm:asm:5.0.4'
}


jar {
    from(configurations.support) {
        into 'dependencies'
    }
}
