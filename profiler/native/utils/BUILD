package(default_visibility = ["//visibility:public"])

cc_library(
    name = "profiler_utils",
    srcs = [
        "activity_manager.cc",
        "app_base.cc",
        "bash_command.cc",
        "clock.cc",
        "file_reader.cc",
        "fs/dir.cc",
        "fs/disk_file_system.cc",
        "fs/file.cc",
        "fs/file_system.cc",
        "fs/path.cc",
        "installer.cc",
        "log.cc",
        "package_manager.cc",
        "profiler_file.cc",
        "stopwatch.cc",
        "thread_name.cc",
        "tokenizer.cc",
        "trace.cc",
    ],
    hdrs = [
        "activity_manager.h",
        "android_studio_version.h",
        "app_base.h",
        "bash_command.h",
        "clock.h",
        "config.h",
        "fake_clock.h",
        "file_reader.h",
        "filesystem_notifier.h",
        "fs/dir.h",
        "fs/disk_file_system.h",
        "fs/file.h",
        "fs/file_system.h",
        "fs/memory_file_system.h",
        "fs/path.h",
        "installer.h",
        "log.h",
        "package_manager.h",
        "profiler_file.h",
        "stopwatch.h",
        "thread_name.h",
        "time_value_buffer.h",
        "timespec_math.h",
        "tokenizer.h",
        "trace.h",
        "uid_fetcher.h",
    ],
    copts = [
        "-Itools/base/profiler/native",
        "-I$(GENDIR)/tools/base/profiler",
        "-DBAZEL",
    ],
)

cc_test(
    name = "profiler_utils_test",
    srcs = [
        "clock_test.cc",
        "file_reader_test.cc",
        "fs/file_system_test.cc",
        "fs/memory_file_system.cc",
        "stopwatch_test.cc",
        "time_value_buffer_test.cc",
        "timespec_math_test.cc",
        "tokenizer_test.cc",
        "uid_fetcher_test.cc",
    ],
    copts = [
        "-Itools/base/profiler/native",
        "-I$(GENDIR)/tools/base/profiler",
        "-DBAZEL",
    ],
    data = [
        "//tools/base/profiler/native/testdata:utils",
    ],
    deps = [
        ":profiler_utils",
        "//external:gmock_main",
    ],
)