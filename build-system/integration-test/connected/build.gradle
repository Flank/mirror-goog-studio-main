apply plugin: 'com.android.tools.java'
apply plugin: 'com.android.tools.kotlin'

repositories {
    maven { url = uri(rootProject.cloneArtifacts.repository) }
}

dependencies {
    implementation project(':base:bazel:avd')
    implementation libs.junit
    implementation project(':base:testutils')
    implementation project(':base:sdklib')


    testImplementation project(':base:build-system:integration-test:framework')
    testImplementation project(':analytics-library:protos')
    testImplementation project(':apksig')
    testImplementation project(':base:builder')
    testImplementation project(':base:builder-model')
    testImplementation project(':base:sdk-common')
    testImplementation project(':base:testing-infrastructure:device-pool:device-provider')
    testImplementation project(':base:testutils')
    testImplementation project(':base:gradle-api')
    testCompileOnly(project(':base:profile'))

    testImplementation libs.kotlin_stdlib
    testImplementation libs.kotlin_test

    testImplementation gradleApi()
    testImplementation libs.apache_commons_io
    testImplementation libs.apache_commons_lang
    testImplementation libs.apache_compress
    testImplementation libs.google_api_client
    testImplementation libs.google_storage_client
    testImplementation libs.junit
    testImplementation libs.protobuf
    testImplementation libs.protobuf_util
    testImplementation libs.truth
    testImplementation libs.unified_test_platform

    testImplementation libs.mockito_core

    // Add dependency on plugin code.  Exclude transitive dependencies to avoid conflict due to
    // Groovy versions.
    testImplementation(project(':base:build-system:gradle-core')) {
        transitive = false
    }
}

configurations {
    // google-api-client depends on guava-jdk5.
    testImplementation.exclude group: 'com.google.guava', module: 'guava-jdk5'
}

apply from: '../integration-tests.gradle'

test {
    dependsOn ':publishLocal'
}
